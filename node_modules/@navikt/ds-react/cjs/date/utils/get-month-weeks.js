"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.daysToMonthWeeks = exports.getMonthWeeks = void 0;
const date_fns_1 = require("date-fns");
function getMonthWeeks(month, options) {
    const _options = Object.assign(Object.assign({}, options), { weekStartsOn: 1 });
    const weeksInMonth = daysToMonthWeeks((0, date_fns_1.startOfMonth)(month), (0, date_fns_1.endOfMonth)(month), _options);
    if (_options === null || _options === void 0 ? void 0 : _options.useFixedWeeks) {
        // Add extra weeks to the month, up to 6 weeks
        const nrOfMonthWeeks = (0, date_fns_1.getWeeksInMonth)(month, _options);
        if (nrOfMonthWeeks < 6) {
            const lastWeek = weeksInMonth[weeksInMonth.length - 1];
            const lastDate = lastWeek.dates[lastWeek.dates.length - 1];
            const toDate = (0, date_fns_1.addWeeks)(lastDate, 6 - nrOfMonthWeeks);
            const extraWeeks = daysToMonthWeeks((0, date_fns_1.addWeeks)(lastDate, 1), toDate, _options);
            weeksInMonth.push(...extraWeeks);
        }
    }
    return weeksInMonth;
}
exports.getMonthWeeks = getMonthWeeks;
/** Return the weeks between two dates.  */
function daysToMonthWeeks(fromDate, toDate, options) {
    const toWeek = (0, date_fns_1.endOfWeek)(toDate, options);
    const fromWeek = (0, date_fns_1.startOfWeek)(fromDate, options);
    const nOfDays = (0, date_fns_1.differenceInCalendarDays)(toWeek, fromWeek);
    const days = [];
    for (let i = 0; i <= nOfDays; i++) {
        days.push((0, date_fns_1.addDays)(fromWeek, i));
    }
    const weeksInMonth = days.reduce((result, date) => {
        const weekNumber = (0, date_fns_1.getWeek)(date, options);
        const existingWeek = result.find((value) => value.weekNumber === weekNumber);
        if (existingWeek) {
            existingWeek.dates.push(date);
            return result;
        }
        result.push({
            weekNumber,
            dates: [date],
        });
        return result;
    }, []);
    return weeksInMonth;
}
exports.daysToMonthWeeks = daysToMonthWeeks;
//# sourceMappingURL=get-month-weeks.js.map